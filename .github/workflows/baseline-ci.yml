name: Baseline CI

on:
  push:
    branches: [main]
  pull_request:
  workflow_dispatch:

permissions:
  contents: read

jobs:
  validate:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Setup Python
        uses: actions/setup-python@v5
        with:
          python-version: "3.11"
      - name: Install validator deps
        run: python -m pip install --upgrade pip pyyaml
      - name: Validate YAML/JSON
        run: |
          python - <<"PY"
          import json, yaml
          from pathlib import Path
          for p in Path(".").rglob("*"):
              if not p.is_file() or ".git" in p.parts:
                  continue
              if p.suffix in {".yml", ".yaml"}:
                  with p.open("r", encoding="utf-8") as f:
                      
                  try:
                      list(yaml.safe_load_all(f))
                  except Exception as e:
                      print(f"WARN YAML {p}: {e}")
              elif p.suffix == ".json":
                  with p.open("r", encoding="utf-8") as f:
                      
                  try:
                      json.load(f)
                  except Exception as e:
                      print(f"WARN JSON {p}: {e}")
          print("validation complete")
          PY
